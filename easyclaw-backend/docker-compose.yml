name: easyclaw-backend

services:
  api-server:
    build:
      context: .
      dockerfile: Dockerfile
    image: easyclaw-backend:local
    command: ["api-server"]
    environment:
      CONFIG_PHASE: docker
    ports:
      - "9998:8080"
    volumes:
      - ./config:/app/config:ro
      - ./.docker/api-server:/app/.docker/api-server
    extra_hosts:
      - "host.docker.internal:host-gateway"

  indexer:
    build:
      context: .
      dockerfile: Dockerfile
    image: easyclaw-backend:local
    command: ["indexer"]
    environment:
      CONFIG_PHASE: docker
    volumes:
      - ./config:/app/config:ro
      - ./.docker/indexer:/app/.docker/indexer
    extra_hosts:
      - "host.docker.internal:host-gateway"

  keeper:
    build:
      context: .
      dockerfile: Dockerfile
    image: easyclaw-backend:local
    command: ["keeper"]
    environment:
      CONFIG_PHASE: docker
    volumes:
      - ./config:/app/config:ro
      - ./.docker/keeper:/app/.docker/keeper
      - ${HOME}/.config/solana/id.json:/app/.docker/keeper/id.json:ro
    extra_hosts:
      - "host.docker.internal:host-gateway"
